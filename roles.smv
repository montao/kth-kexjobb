MODULE main
VAR
	user : {root, restricted};
	state : {secure, nonsecure};
	config : {open, closed};
ASSIGN
	init (state) := secure;
	init (config) := closed;
	next (state) :=
		case
			config = closed : secure;
			state = secure & (user = root) & (config = open) : nonsecure;
			config = closed : secure;
			TRUE : {secure, nonsecure};
		esac;
SPEC AG ((user = root) -> AF state = nonsecure)